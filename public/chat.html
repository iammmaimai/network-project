<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/style.css" />
    <title>Pingu TALK!</title>
  </head>
  <body>
    <div class="chat-container">
      <header class="chat-header">
        <h1><i class="fas fa-light fa-snowflake"></i> Pingu</h1>
        <a id="leave-btn" class="btn">Leave Room</a>
      </header>
      <main class="chat-main">
        <div class="chat-sidebar">
          <!-- Room Section -->
          <div class="sidebar-section">
            <h3><i class="fas fa-door-open"></i> Current Chat</h3>
            <h2 id="room-name" class="clickable"></h2>
            <!-- <h4><i class="fas fa-users"></i> Users in Room (<span id="room-users-count">0</span>)</h4> -->
            <!-- <ul id="users"></ul> -->
          </div>

          <!-- Total Server Users Section -->
          <div class="sidebar-section">
            <!-- <h3><i class="fas fa-server"></i> Server Stats</h3> -->
            <!-- <div class="stats-display">
              <div class="stat-item">
                <i class="fas fa-globe"></i>
                <span class="stat-label">Total Online:</span>
                <span class="stat-value" id="total-users-count">0</span>
              </div>
            </div> -->
            <h4><i class="fas fa-list"></i> All Users</h4>
            <ul id="total-users-list"></ul>
          </div>

          <!-- Groups Section -->
          <div class="sidebar-section">
            <h3><i class="fas fa-users-cog"></i> My Groups</h3>
            <button id="create-group-btn" class="btn btn-small">
              <i class="fas fa-plus"></i> Create Group
            </button>
            <ul id="my-groups"></ul>
          </div>

          <!-- All Groups Section -->
          <div class="sidebar-section">
            <h3><i class="fas fa-globe"></i> All Groups</h3>
            <button id="refresh-groups-btn" class="btn btn-small">
              <i class="fas fa-sync"></i> Refresh
            </button>
            <ul id="all-groups"></ul>
          </div>

          <!-- DM Section -->
          <div class="sidebar-section">
            <h3><i class="fas fa-envelope"></i> Direct Messages</h3>
            <button id="show-dm-users" class="btn btn-small">
              <i class="fas fa-plus"></i> New DM
            </button>
            <ul id="dm-conversations"></ul>
          </div>
        </div>

        <!-- Create Group Modal -->
        <div id="create-group-modal" class="modal">
          <div class="modal-content">
            <span class="close" data-modal="create-group-modal">&times;</span>
            <h3>Create New Group</h3>
            <form id="create-group-form">
              <input 
                type="text" 
                id="group-name-input" 
                placeholder="Enter group name..." 
                required 
                maxlength="30"
              />
              <button type="submit" class="btn">Create</button>
            </form>
          </div>
        </div>

        <!-- Group Details Modal -->
        <div id="group-details-modal" class="modal">
          <div class="modal-content">
            <span class="close" data-modal="group-details-modal">&times;</span>
            <h3 id="group-details-name"></h3>
            <p><strong>Creator:</strong> <span id="group-details-creator"></span></p>
            <h4>Members (<span id="group-details-member-count"></span>):</h4>
            <ul id="group-details-members"></ul>
            <div id="group-actions"></div>
          </div>
        </div>

        <!-- DM User Modal -->
        <div id="dm-modal" class="modal">
          <div class="modal-content">
            <span class="close" data-modal="dm-modal">&times;</span>
            <h3>Select User to Message</h3>
            <ul id="available-users"></ul>
          </div>
        </div>

        <div class="chat-messages"></div>
      </main>

      <div class="chat-form-container">
        <form id="chat-form">
          <input
            id="msg"
            type="text"
            placeholder="Enter Message"
            autocomplete="off"
          />
      
          <!-- ğŸ‘‡ Image upload button -->
          <input type="file" id="image-input" accept="image/*" style="display: none;" />
          <button type="button" id="image-btn" class="btn btn-emoji" title="Upload Image">
            <i class="fas fa-image"></i>
          </button>
      
          <!-- ğŸ‘‡ New emoji button -->
          <button type="button" id="emoji-btn" class="btn btn-emoji">
            <i class="fas fa-smile"></i>
          </button>
      
          <button class="btn"><i class="fas fa-paper-plane"></i> Send</button>
        </form>
      
        <!-- ğŸ‘‡ Simple emoji picker panel -->
        <div id="emoji-picker" class="emoji-picker hidden">
          <button type="button" class="emoji-item">ğŸ˜€</button>
          <button type="button" class="emoji-item">ğŸ˜‚</button>
          <button type="button" class="emoji-item">ğŸ˜</button>
          <button type="button" class="emoji-item">ğŸ˜</button>
          <button type="button" class="emoji-item">ğŸ¤”</button>
          <button type="button" class="emoji-item">ğŸ‘</button>
          <button type="button" class="emoji-item">ğŸ™</button>
          <button type="button" class="emoji-item">ğŸ”¥</button>
          <button type="button" class="emoji-item">â¤ï¸</button>
        </div>
      </div>
      
    </div>

    <!-- ---------------- SCRIPT LOADING ---------------- -->

    <!-- 1. Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.9.2/qs.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <!-- 2. Helper functions -->
    <script src="js/uiHelpers.js"></script>

    <!-- 3. Managers -->
    <script src="js/groupManager.js"></script>
    <script src="js/dmManager.js"></script>

    <!-- 4. Main script (load last) -->
    <script src="js/main.js"></script>
  </body>
</html>